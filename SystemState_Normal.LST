C51 COMPILER V9.60.0.0   SYSTEMSTATE_NORMAL                                                05/22/2022 00:44:30 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE SYSTEMSTATE_NORMAL
OBJECT MODULE PLACED IN SystemState_Normal.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE SystemState_Normal.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND T
                    -ABS(2)

line level    source

   1          #include "reg51.h"
   2          #include "SystemManageDef.h"
   3          #include "SystemState_Normal.h"
   4          #include "SystemManage.h"
   5          #include "type.h"
   6          #include "usart.h"
   7          #include "string.h"
   8          #include "modbustimer.h"
   9          #include "timer_UsingTimer0.h"
  10          #include "register.h"
  11          
  12          
  13          #define LD3 P11
  14          #define LD4 P10
  15          #define TEST_PORT_PIN P12
  16          
  17          sbit P10 = P1^0;
  18          sbit P11 = P1^1;
  19          sbit P13 = P1^3;
  20          sbit P00 = P0^0;
  21          
  22          static u8 g_10ms_cnt = 0;
  23          u32 g_10ms_uart2_recv_timeout = 0;
  24          extern u32 g_current_system_time;
  25          extern u32 g_history_system_time;
  26          
  27          
  28          void System_Normal_Task(void)
  29          {
  30   1        u8 i;
  31   1      
  32   1        Notify_ModbusRtu_Register_IsReceived_Message();
  33   1        reg_monitor();
  34   1        
  35   1        if (SystemState_TimeSlice_Obtain(System_TimeSlice_1ms)  == System_TimeSlice_ObtainSuccess)
  36   1          {
  37   2      
  38   2      
  39   2          if (SystemState_TimeSlice_Obtain(System_TimeSlice_10ms)//10ms
  40   2            == System_TimeSlice_ObtainSuccess)
  41   2          {
  42   3              if(g_10ms_cnt++ >= 20)
  43   3              {
  44   4                g_10ms_cnt = 0;     
  45   4              }
  46   3              if(g_10ms_uart2_recv_timeout++ >= 5)
  47   3              {
  48   4                Usart2_Runtime_Var.Uart_RecvData_IsNewFrame = true;
  49   4                g_10ms_uart2_recv_timeout = 0;
  50   4              }
  51   3            
  52   3          }
  53   2      
  54   2           if (SystemState_TimeSlice_Obtain(System_TimeSlice_20ms)//20ms
C51 COMPILER V9.60.0.0   SYSTEMSTATE_NORMAL                                                05/22/2022 00:44:30 PAGE 2   

  55   2                      == System_TimeSlice_ObtainSuccess)
  56   2              {
  57   3      //          if(true == timer_usingTimer0_IsTimerout(0,3000))
  58   3      //          {
  59   3      //            
  60   3      //        SendString("timer_usingTimer0_IsTimerout(0,3000)\r\n");
  61   3      //        timer_usingTimer0_StartTimer(0);
  62   3      //      }
  63   3      //        
  64   3              }
  65   2      
  66   2          if (SystemState_TimeSlice_Obtain(System_TimeSlice_50ms)
  67   2                      == System_TimeSlice_ObtainSuccess)
  68   2              {
  69   3                //LD4 = !LD4;
  70   3            if((false == Usart2_Runtime_Var.Uart_RecvData_IsNewFrame) && (true == Usart2_Runtime_Var.Uart_RecvData_
             -Notificatio))
  71   3            {
  72   4      #if 0
                      for(i = 0;i <Usart2_Runtime_Var.Uart_RecvData_Pos;i++)
                      {
                        SendData(Usart2_Runtime_Var.Local_Uart2Rec_Buf[i]);
                      }
                      memset(Usart2_Runtime_Var.Local_Uart2Rec_Buf,0x0,50);
                      Usart2_Runtime_Var.Uart_RecvData_Notificatio = false;
                      Usart2_Runtime_Var.Uart_RecvData_Pos = 0;
              #endif      
  81   4            }
  82   3                
  83   3              }   
  84   2      
  85   2           if (SystemState_TimeSlice_Obtain(System_TimeSlice_100ms)
  86   2                      == System_TimeSlice_ObtainSuccess)
  87   2              {
  88   3                
  89   3              }
  90   2      
  91   2           if (SystemState_TimeSlice_Obtain(System_TimeSlice_200ms)
  92   2                      == System_TimeSlice_ObtainSuccess)
  93   2              {
  94   3              }
  95   2      
  96   2          if (SystemState_TimeSlice_Obtain(System_TimeSlice_500ms)
  97   2                      == System_TimeSlice_ObtainSuccess)
  98   2              {
  99   3          }
 100   2      
 101   2          if (SystemState_TimeSlice_Obtain(System_TimeSlice_1s)
 102   2                      == System_TimeSlice_ObtainSuccess)
 103   2          {
 104   3            //LD4 = !LD4;
 105   3          }
 106   2      
 107   2          if (SystemState_TimeSlice_Obtain(System_TimeSlice_2s)
 108   2                  == System_TimeSlice_ObtainSuccess)
 109   2          {
 110   3            
 111   3          }
 112   2      
 113   2          if (SystemState_TimeSlice_Obtain(System_TimeSlice_5s)
 114   2                  == System_TimeSlice_ObtainSuccess)
 115   2          {
C51 COMPILER V9.60.0.0   SYSTEMSTATE_NORMAL                                                05/22/2022 00:44:30 PAGE 3   

 116   3              //LD3 = !LD3;
 117   3          }
 118   2        }
 119   1      }
*** WARNING C280 IN LINE 30 OF SystemState_Normal.c: 'i': unreferenced local variable
 120          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    139    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      3       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
